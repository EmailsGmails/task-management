%h1 All Tasks

= form_with url: tasks_path, method: :get, local: true do |f|
  %div
    = f.label :status, "Filter by Status"
    = f.select :status, options_for_select(Task.statuses.values, params[:status]), include_blank: true
  %div
    = f.label :sort, "Sort by"
    = f.select :sort, options_for_select([['Due Date', :due_date], ['Status', :status]], params[:sort]), include_blank: true
  %div
    = f.submit 'Filter'

%table
  %thead
    %tr
      %th Name
      %th Description
      %th Due Date
      %th Status
      %th Assigned To
      %th Assigned By
      %th Created By
      %th Action
  %tbody
    - @tasks.each do |task|
      %tr
        %td= link_to task.name, task_path(task)
        %td= task.description
        %td= task.due_date ? l(task.due_date) : "No due date"
        %td= task.status
        %td= task.assigned_to&.email
        %td= task.assigned_by&.email
        %td= task.created_by&.email
        %td
          = link_to 'Show', task_path(task)
          |
          = link_to 'Edit', edit_task_path(task)
          |
          = link_to 'Destroy', task_path(task), method: :delete, data: { confirm: 'Are you sure?' }
.actions
  = link_to 'Create Task', new_task_path, class: 'btn btn-primary'
